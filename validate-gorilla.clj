;; gorilla-repl.fileformat = 1

;; **
;;; # SEND Validation
;; **

;; @@
(ns witan.send.validate.gorilla
  (:require [gorilla-plot.core :as plot]
            [witan.send.validate :refer :all]
            [gg4clj.core :as gg4clj]))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(defn ci-across-years
  [data from until]
  (map #(confidence-interval data %) (range from until)))

(def joiner-result (ci-across-years (joiner-rate) 2013 2017))

(def leaver-result (ci-across-years (leaver-rate) 2013 2017))

(def mover-result (ci-across-years (mover-rate) 2013 2017))

(apply mapv vector (first joiner-result))
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-5</span>","value":"-5"},{"type":"html","content":"<span class='clj-long'>-4</span>","value":"-4"},{"type":"html","content":"<span class='clj-long'>-3</span>","value":"-3"},{"type":"html","content":"<span class='clj-long'>-2</span>","value":"-2"},{"type":"html","content":"<span class='clj-long'>-1</span>","value":"-1"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>1</span>","value":"1"},{"type":"html","content":"<span class='clj-long'>2</span>","value":"2"},{"type":"html","content":"<span class='clj-long'>3</span>","value":"3"},{"type":"html","content":"<span class='clj-long'>4</span>","value":"4"},{"type":"html","content":"<span class='clj-long'>5</span>","value":"5"},{"type":"html","content":"<span class='clj-long'>6</span>","value":"6"},{"type":"html","content":"<span class='clj-long'>7</span>","value":"7"},{"type":"html","content":"<span class='clj-long'>8</span>","value":"8"},{"type":"html","content":"<span class='clj-long'>9</span>","value":"9"},{"type":"html","content":"<span class='clj-long'>10</span>","value":"10"},{"type":"html","content":"<span class='clj-long'>11</span>","value":"11"},{"type":"html","content":"<span class='clj-long'>12</span>","value":"12"},{"type":"html","content":"<span class='clj-long'>13</span>","value":"13"},{"type":"html","content":"<span class='clj-long'>14</span>","value":"14"},{"type":"html","content":"<span class='clj-long'>15</span>","value":"15"},{"type":"html","content":"<span class='clj-long'>16</span>","value":"16"},{"type":"html","content":"<span class='clj-long'>17</span>","value":"17"},{"type":"html","content":"<span class='clj-long'>18</span>","value":"18"},{"type":"html","content":"<span class='clj-long'>19</span>","value":"19"},{"type":"html","content":"<span class='clj-long'>20</span>","value":"20"},{"type":"html","content":"<span class='clj-long'>21</span>","value":"21"},{"type":"html","content":"<span class='clj-long'>22</span>","value":"22"},{"type":"html","content":"<span class='clj-long'>23</span>","value":"23"},{"type":"html","content":"<span class='clj-long'>24</span>","value":"24"},{"type":"html","content":"<span class='clj-long'>25</span>","value":"25"}],"value":"[-5 -4 -3 -2 -1 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25]"},{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-double'>2.934244552270142E-6</span>","value":"2.934244552270142E-6"},{"type":"html","content":"<span class='clj-double'>8.355344905842896E-4</span>","value":"8.355344905842896E-4"},{"type":"html","content":"<span class='clj-double'>0.0049127261867473754</span>","value":"0.0049127261867473754"},{"type":"html","content":"<span class='clj-double'>0.004819625173508606</span>","value":"0.004819625173508606"},{"type":"html","content":"<span class='clj-double'>0.0028330245383216333</span>","value":"0.0028330245383216333"},{"type":"html","content":"<span class='clj-double'>0.0017624370355465678</span>","value":"0.0017624370355465678"},{"type":"html","content":"<span class='clj-double'>7.480058565034742E-4</span>","value":"7.480058565034742E-4"},{"type":"html","content":"<span class='clj-double'>0.001320819187297617</span>","value":"0.001320819187297617"},{"type":"html","content":"<span class='clj-double'>8.75679253316361E-4</span>","value":"8.75679253316361E-4"},{"type":"html","content":"<span class='clj-double'>0.0011767105335412568</span>","value":"0.0011767105335412568"},{"type":"html","content":"<span class='clj-double'>5.011861719648424E-4</span>","value":"5.011861719648424E-4"},{"type":"html","content":"<span class='clj-double'>4.1454433704046946E-4</span>","value":"4.1454433704046946E-4"},{"type":"html","content":"<span class='clj-double'>7.642208838452268E-4</span>","value":"7.642208838452268E-4"},{"type":"html","content":"<span class='clj-double'>5.332853095680266E-4</span>","value":"5.332853095680266E-4"},{"type":"html","content":"<span class='clj-double'>1.9772432060664223E-4</span>","value":"1.9772432060664223E-4"},{"type":"html","content":"<span class='clj-double'>4.697822914661964E-6</span>","value":"4.697822914661964E-6"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"}],"value":"[0 0 2.934244552270142E-6 8.355344905842896E-4 0.0049127261867473754 0.004819625173508606 0.0028330245383216333 0.0017624370355465678 7.480058565034742E-4 0.001320819187297617 8.75679253316361E-4 0.0011767105335412568 5.011861719648424E-4 4.1454433704046946E-4 7.642208838452268E-4 5.332853095680266E-4 1.9772432060664223E-4 4.697822914661964E-6 0 0 0 0 0 0 0 0 0 0 0 0 0]"},{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-double'>4.274560696543298E-4</span>","value":"4.274560696543298E-4"},{"type":"html","content":"<span class='clj-double'>0.002528086316335522</span>","value":"0.002528086316335522"},{"type":"html","content":"<span class='clj-double'>0.008559911323957118</span>","value":"0.008559911323957118"},{"type":"html","content":"<span class='clj-double'>0.008495587058090392</span>","value":"0.008495587058090392"},{"type":"html","content":"<span class='clj-double'>0.005820671255296535</span>","value":"0.005820671255296535"},{"type":"html","content":"<span class='clj-double'>0.0042751298824579825</span>","value":"0.0042751298824579825"},{"type":"html","content":"<span class='clj-double'>0.002662410061356277</span>","value":"0.002662410061356277"},{"type":"html","content":"<span class='clj-double'>0.0036911611751512365</span>","value":"0.0036911611751512365"},{"type":"html","content":"<span class='clj-double'>0.002929707665021665</span>","value":"0.002929707665021665"},{"type":"html","content":"<span class='clj-double'>0.003559154765550791</span>","value":"0.003559154765550791"},{"type":"html","content":"<span class='clj-double'>0.0023235303037589285</span>","value":"0.0023235303037589285"},{"type":"html","content":"<span class='clj-double'>0.002194807292173498</span>","value":"0.002194807292173498"},{"type":"html","content":"<span class='clj-double'>0.0029240456594615753</span>","value":"0.0029240456594615753"},{"type":"html","content":"<span class='clj-double'>0.0024721999647764115</span>","value":"0.0024721999647764115"},{"type":"html","content":"<span class='clj-double'>0.0015894591362658154</span>","value":"0.0015894591362658154"},{"type":"html","content":"<span class='clj-double'>6.842859872513468E-4</span>","value":"6.842859872513468E-4"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"}],"value":"[0 0 4.274560696543298E-4 0.002528086316335522 0.008559911323957118 0.008495587058090392 0.005820671255296535 0.0042751298824579825 0.002662410061356277 0.0036911611751512365 0.002929707665021665 0.003559154765550791 0.0023235303037589285 0.002194807292173498 0.0029240456594615753 0.0024721999647764115 0.0015894591362658154 6.842859872513468E-4 0 0 0 0 0 0 0 0 0 0 0 0 0]"}],"value":"[[-5 -4 -3 -2 -1 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25] [0 0 2.934244552270142E-6 8.355344905842896E-4 0.0049127261867473754 0.004819625173508606 0.0028330245383216333 0.0017624370355465678 7.480058565034742E-4 0.001320819187297617 8.75679253316361E-4 0.0011767105335412568 5.011861719648424E-4 4.1454433704046946E-4 7.642208838452268E-4 5.332853095680266E-4 1.9772432060664223E-4 4.697822914661964E-6 0 0 0 0 0 0 0 0 0 0 0 0 0] [0 0 4.274560696543298E-4 0.002528086316335522 0.008559911323957118 0.008495587058090392 0.005820671255296535 0.0042751298824579825 0.002662410061356277 0.0036911611751512365 0.002929707665021665 0.003559154765550791 0.0023235303037589285 0.002194807292173498 0.0029240456594615753 0.0024721999647764115 0.0015894591362658154 6.842859872513468E-4 0 0 0 0 0 0 0 0 0 0 0 0 0]]"}
;; <=

;; @@
(defn ribbon-plot
  [data]
  (map #(let [format (apply mapv vector %) 
      		[year upper lower] format]
  (gg4clj/view [[:<- :foo (gg4clj/data-frame 
                            {:year year :upper upper :lower lower})]
                (gg4clj/r+ 
                  [:ggplot :foo [:aes {:factor :year} :upper]]
                  [:geom_ribbon [:aes {:ymax :upper :ymin :lower}] {:fill "grey70"}]
                  [:xlab "academic years"]
                  [:theme_bw])]))
     data))

(defn pull-year
  [data pos]
  (apply mapv vector (nth data pos)))

(defn ribbon-plot2
  [data]
  (let [year1 (pull-year data 0)
        year2 (pull-year data 1)
        year3 (pull-year data 2)
        year4 (pull-year data 3)
      	[ay upper1 lower1] year1
        [_ upper2 lower2] year2
        [_ upper3 lower3] year3
        [_ upper4 lower4] year4]
  (gg4clj/view [[:<- :foo (gg4clj/data-frame 
                            {:year ay :upper1 upper1 :lower1 lower1 :upper2 upper2 :lower2 lower2 :upper3 upper3 :lower3 lower3 :upper4 upper4 :lower4 lower4})]
                (gg4clj/r+ 
                  [:ggplot :foo [:aes :year :upper1]]
                  [:geom_ribbon [:aes {:ymax :upper1 :ymin :lower1}] {:fill "red" :alpha 0.4}]
                  [:geom_ribbon [:aes {:ymax :upper2 :ymin :lower2}] {:fill "yellow" :alpha 0.4}]
                  [:geom_ribbon [:aes {:ymax :upper3 :ymin :lower3}] {:fill "grey" :alpha 0.4}]
                  [:geom_ribbon [:aes {:ymax :upper4 :ymin :lower4}] {:fill "blue" :alpha 0.2}]
                  [:xlab "academic years"]
                  [:theme ]
                  )])))

(ribbon-plot2 joiner-result)
;; @@
;; =>
;;; {"type":"html","content":"<?xml version='1.0' encoding='UTF-8'?>\n<svg viewBox='0 0 468.00 289.25' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns='http://www.w3.org/2000/svg'>\n<defs>\n<style type='text/css'>\n\n    line, polyline, path, rect, circle {\n      fill: none;\n      stroke: #000000;\n      stroke-linecap: round;\n      stroke-linejoin: round;\n      stroke-miterlimit: 10.00;\n    }\n  \n</style>\n</defs>\n<rect style='stroke: none; fill: #FFFFFF;' height='100%' width='100%'/>\n<rect style='stroke-width: 1.07; stroke: #FFFFFF; fill: #FFFFFF;' height='289.25' width='468.00' y='-0.00' x='0.00'/>\n<defs>\n<clipPath id='ab32cbf6-e80a-409a-a608-b11bbb98ec5f'>\n<rect height='251.03' width='408.84' y='5.48' x='53.68'/>\n</clipPath>\n</defs>\n<rect clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: none; fill: #EBEBEB;' height='251.03' width='408.84' y='5.48' x='53.68'/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' points='53.68,212.49 462.52,212.49 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' points='53.68,147.26 462.52,147.26 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' points='53.68,82.04 462.52,82.04 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' points='53.68,16.81 462.52,16.81 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' points='72.27,256.51 72.27,5.48 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' points='196.16,256.51 196.16,5.48 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' points='320.05,256.51 320.05,5.48 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' points='443.94,256.51 443.94,5.48 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' points='53.68,245.10 462.52,245.10 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' points='53.68,179.88 462.52,179.88 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' points='53.68,114.65 462.52,114.65 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' points='53.68,49.43 462.52,49.43 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' points='134.21,256.51 134.21,5.48 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' points='258.10,256.51 258.10,5.48 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' points='381.99,256.51 381.99,5.48 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: none; fill: #FF0000; fill-opacity: 0.40;' points='72.27,245.10 84.66,245.10 97.04,245.02 109.43,223.30 121.82,116.93 134.21,119.36 146.60,171.19 158.99,199.12 171.38,225.59 183.77,210.64 196.16,222.25 208.55,214.40 220.93,232.03 233.32,234.29 245.71,225.16 258.10,231.19 270.49,239.94 282.88,244.98 295.27,245.10 307.66,245.10 320.05,245.10 332.44,245.10 344.82,245.10 357.21,245.10 369.60,245.10 381.99,245.10 394.38,245.10 406.77,245.10 419.16,245.10 431.55,245.10 443.94,245.10 443.94,245.10 431.55,245.10 419.16,245.10 406.77,245.10 394.38,245.10 381.99,245.10 369.60,245.10 357.21,245.10 344.82,245.10 332.44,245.10 320.05,245.10 307.66,245.10 295.27,245.10 282.88,227.25 270.49,203.63 258.10,180.60 245.71,168.81 233.32,187.84 220.93,184.48 208.55,152.24 196.16,168.67 183.77,148.80 171.38,175.64 158.99,133.56 146.60,93.24 134.21,23.45 121.82,21.77 109.43,179.14 97.04,233.95 84.66,245.10 72.27,245.10 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: none; fill: #FFFF00; fill-opacity: 0.40;' points='72.27,245.10 84.66,245.10 97.04,245.10 109.43,212.47 121.82,159.89 134.21,112.69 146.60,162.91 158.99,174.91 171.38,193.71 183.77,192.56 196.16,211.06 208.55,219.84 220.93,195.21 233.32,235.03 245.71,228.37 258.10,225.75 270.49,237.35 282.88,240.18 295.27,244.04 307.66,244.20 320.05,245.10 332.44,245.10 344.82,245.10 357.21,245.10 369.60,245.05 381.99,245.10 394.38,245.10 406.77,245.10 419.16,245.10 431.55,245.10 443.94,245.10 443.94,245.10 431.55,245.10 419.16,245.10 406.77,245.10 394.38,245.10 381.99,245.10 369.60,238.31 357.21,245.10 344.82,245.10 332.44,245.10 320.05,245.10 307.66,224.30 295.27,220.65 282.88,205.50 270.49,196.22 258.10,171.04 245.71,175.30 233.32,191.75 220.93,121.20 208.55,165.01 196.16,149.97 183.77,120.44 171.38,125.60 158.99,99.06 146.60,83.58 134.21,16.89 121.82,83.74 109.43,161.92 97.04,245.10 84.66,245.10 72.27,245.10 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: none; fill: #BEBEBE; fill-opacity: 0.40;' points='72.27,245.10 84.66,245.10 97.04,245.03 109.43,208.02 121.82,152.11 134.21,139.10 146.60,159.81 158.99,171.80 171.38,215.12 183.77,227.59 196.16,225.82 208.55,233.78 220.93,222.90 233.32,233.08 245.71,223.62 258.10,225.73 270.49,226.34 282.88,242.28 295.27,242.57 307.66,245.02 320.05,245.10 332.44,245.10 344.82,244.47 357.21,245.05 369.60,245.10 381.99,245.10 394.38,245.10 406.77,245.10 419.16,245.10 431.55,245.10 443.94,245.10 443.94,245.10 431.55,245.10 419.16,245.10 406.77,245.10 394.38,245.10 381.99,245.10 369.60,245.10 357.21,237.06 344.82,230.53 332.44,245.10 320.05,245.10 307.66,232.67 295.27,215.61 282.88,212.23 270.49,173.31 258.10,170.99 245.71,168.63 233.32,189.38 220.93,170.82 208.55,192.59 196.16,176.47 183.77,182.77 171.38,161.31 158.99,96.27 146.60,80.70 134.21,55.89 121.82,74.48 109.43,157.07 97.04,234.82 84.66,245.10 72.27,245.10 '/>\n<polyline clip-path='url(#ab32cbf6-e80a-409a-a608-b11bbb98ec5f)' style='stroke-width: 1.07; stroke: none; fill: #0000FF; fill-opacity: 0.20;' points='72.27,245.10 84.66,245.10 97.04,245.02 109.43,229.40 121.82,181.35 134.21,132.83 146.60,198.83 158.99,211.23 171.38,196.70 183.77,230.24 196.16,213.94 208.55,222.79 220.93,210.70 233.32,242.57 245.71,218.33 258.10,207.67 270.49,231.99 282.88,220.41 295.27,240.48 307.66,239.76 320.05,245.03 332.44,242.09 344.82,243.50 357.21,244.56 369.60,245.05 381.99,245.10 394.38,245.10 406.77,245.10 419.16,245.10 431.55,245.10 443.94,245.10 443.94,245.10 431.55,245.10 419.16,245.10 406.77,245.10 394.38,245.10 381.99,245.10 369.60,238.12 357.21,232.56 344.82,226.47 332.44,220.91 320.05,234.25 307.66,211.45 295.27,207.99 282.88,162.51 270.49,184.33 258.10,140.50 245.71,160.22 233.32,215.56 220.93,148.97 208.55,170.45 196.16,158.01 183.77,188.24 171.38,132.56 158.99,156.32 146.60,139.51 134.21,48.32 121.82,117.10 109.43,192.54 97.04,233.95 84.66,245.10 72.27,245.10 '/>\n<defs>\n<clipPath id='4756a35e-e961-443c-b939-17f7b18d45c6'>\n<rect height='289.25' width='468.00' y='0.00' x='0.00'/>\n</clipPath>\n</defs>\n<g clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)'>\n<text lengthAdjust='spacingAndGlyphs' textLength='27.53px' style='font-size: 8.80px; fill: #4D4D4D; font-family: Arial;' y='248.32' x='21.22'>\n0.0000\n</text>\n</g>\n<g clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)'>\n<text lengthAdjust='spacingAndGlyphs' textLength='27.53px' style='font-size: 8.80px; fill: #4D4D4D; font-family: Arial;' y='183.10' x='21.22'>\n0.0025\n</text>\n</g>\n<g clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)'>\n<text lengthAdjust='spacingAndGlyphs' textLength='27.53px' style='font-size: 8.80px; fill: #4D4D4D; font-family: Arial;' y='117.87' x='21.22'>\n0.0050\n</text>\n</g>\n<g clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)'>\n<text lengthAdjust='spacingAndGlyphs' textLength='27.53px' style='font-size: 8.80px; fill: #4D4D4D; font-family: Arial;' y='52.65' x='21.22'>\n0.0075\n</text>\n</g>\n<polyline clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' points='50.94,245.10 53.68,245.10 '/>\n<polyline clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' points='50.94,179.88 53.68,179.88 '/>\n<polyline clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' points='50.94,114.65 53.68,114.65 '/>\n<polyline clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' points='50.94,49.43 53.68,49.43 '/>\n<polyline clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' points='134.21,259.25 134.21,256.51 '/>\n<polyline clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' points='258.10,259.25 258.10,256.51 '/>\n<polyline clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' points='381.99,259.25 381.99,256.51 '/>\n<g clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)'>\n<text lengthAdjust='spacingAndGlyphs' textLength='5.01px' style='font-size: 8.80px; fill: #4D4D4D; font-family: Arial;' y='267.88' x='131.71'>\n0\n</text>\n</g>\n<g clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)'>\n<text lengthAdjust='spacingAndGlyphs' textLength='10.01px' style='font-size: 8.80px; fill: #4D4D4D; font-family: Arial;' y='267.88' x='253.10'>\n10\n</text>\n</g>\n<g clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)'>\n<text lengthAdjust='spacingAndGlyphs' textLength='10.01px' style='font-size: 8.80px; fill: #4D4D4D; font-family: Arial;' y='267.88' x='376.99'>\n20\n</text>\n</g>\n<g clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)'>\n<text lengthAdjust='spacingAndGlyphs' textLength='77.03px' style='font-size: 11.00px; font-family: Arial;' y='281.24' x='219.59'>\nacademic years\n</text>\n</g>\n<g clip-path='url(#4756a35e-e961-443c-b939-17f7b18d45c6)'>\n<text lengthAdjust='spacingAndGlyphs' textLength='34.25px' style='font-size: 11.00px; font-family: Arial;' transform='translate(13.35,148.12) rotate(-90)'>\nupper1\n</text>\n</g>\n</svg>\n","value":"#gg4clj.core.GGView{:plot-command [[:<- :foo [:data.frame {:upper1 [:c 0 0 2.934244552270142E-6 8.355344905842896E-4 0.0049127261867473754 0.004819625173508606 0.0028330245383216333 0.0017624370355465678 7.480058565034742E-4 0.001320819187297617 8.75679253316361E-4 0.0011767105335412568 5.011861719648424E-4 4.1454433704046946E-4 7.642208838452268E-4 5.332853095680266E-4 1.9772432060664223E-4 4.697822914661964E-6 0 0 0 0 0 0 0 0 0 0 0 0 0], :lower3 [:c 0 0 3.939908240916684E-4 0.0033741387403505942 0.00653956811883664 0.007252355015647611 0.006301292735211494 0.005704603936300707 0.0032117077995941126 0.0023891340428515654 0.002630436693329221 0.0020127012803568397 0.0028471579972025713 0.0021358095315375364 0.00293097874818234 0.002840785615567453 0.002751528874426821 0.0012600584072796003 0.001130338748125795 4.764243201412553E-4 0 0 5.585446412949758E-4 3.083614046674875E-4 0 0 0 0 0 0 0], :lower4 [:c 0 0 4.2740654307599885E-4 0.0020146756562926162 0.00490628160724024 0.007542343048775791 0.004047344426832365 0.003402699665029158 0.004313712117689254 0.0021793783507384496 0.003338135864131337 0.002861333549235273 0.0036847918624736565 0.001132287421378557 0.003253582353728807 0.004009323897538152 0.0023293324053720813 0.003165730709077974 0.0014225924918369228 0.0012896904563608788 4.1584307936819376E-4 9.273726076007642E-4 7.142818941919352E-4 4.807166431466223E-4 2.6746779236489914E-4 0 0 0 0 0 0], :year [:c -5 -4 -3 -2 -1 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25], :upper4 [:c 0 0 2.9339045184500147E-6 6.019858304142942E-4 0.0024435524987616833 0.0043031770054487275 0.0017736638032104465 0.001298268400933144 0.001855026475149325 5.694396667411327E-4 0.0011943593392584847 8.552219828168317E-4 0.001318537333331329 9.701144411814018E-5 0.0010261438427553952 0.0014348149413823173 5.024388231452067E-4 9.463039638038314E-4 1.769536283506598E-4 2.045514217288463E-4 2.8545140752450046E-6 1.1532916189425742E-4 6.118617798630292E-5 2.0902416231216107E-5 1.8359324786976008E-6 0 0 0 0 0 0], :lower1 [:c 0 0 4.274560696543298E-4 0.002528086316335522 0.008559911323957118 0.008495587058090392 0.005820671255296535 0.0042751298824579825 0.002662410061356277 0.0036911611751512365 0.002929707665021665 0.003559154765550791 0.0023235303037589285 0.002194807292173498 0.0029240456594615753 0.0024721999647764115 0.0015894591362658154 6.842859872513468E-4 0 0 0 0 0 0 0 0 0 0 0 0 0], :upper2 [:c 0 0 0 0.001250808732823891 0.0032658800038088713 0.005075346153598192 0.003150273321248721 0.0026904755089341374 0.00196978312197022 0.00201368397849501 0.0013048072905738613 9.681437522148915E-4 0.0019123673306819524 3.8618897642351066E-4 6.413532059783924E-4 7.419022474541985E-4 2.972433528429344E-4 1.8881792364337124E-4 4.07579923809472E-5 3.466758780657458E-5 0 0 0 0 1.785821750267727E-6 0 0 0 0 0 0], :lower2 [:c 0 0 0 0.003188273098331895 0.006184764576232197 0.008747091173279804 0.006191055760631108 0.005597793013272162 0.004580220505377056 0.004778191413901288 0.0036464666009357496 0.0030698772933492606 0.0047490271032897685 0.0020448030320455663 0.0026754669728736506 0.0028387392662767735 0.0018736480575333994 0.0015179100156860108 9.371531697854698E-4 7.971692627263524E-4 0 0 0 0 2.601679318498526E-4 0 0 0 0 0 0], :upper3 [:c 0 0 2.7044908624919718E-6 0.0014213912648965371 0.0035642561592326093 0.004062785909244017 0.0032689771903406106 0.0028097004460274464 0.001149077627049763 6.71162734626252E-4 7.390144466085322E-4 4.340870647849211E-4 8.50980867479737E-4 4.606606356121626E-4 8.235401307247396E-4 7.424376275055704E-4 7.190865228076999E-4 1.0796479692248107E-4 9.684439979737859E-5 3.270455225797981E-6 0 0 2.428742449822985E-5 2.1166405299869464E-6 0 0 0 0 0 0 0]}]] [:+ [:+ [:+ [:+ [:+ [:+ [:ggplot :foo [:aes :year :upper1]] [:geom_ribbon [:aes {:ymax :upper1, :ymin :lower1}] {:fill \"red\", :alpha 0.4}]] [:geom_ribbon [:aes {:ymax :upper2, :ymin :lower2}] {:fill \"yellow\", :alpha 0.4}]] [:geom_ribbon [:aes {:ymax :upper3, :ymin :lower3}] {:fill \"grey\", :alpha 0.4}]] [:geom_ribbon [:aes {:ymax :upper4, :ymin :lower4}] {:fill \"blue\", :alpha 0.2}]] [:xlab \"academic years\"]] [:theme]]], :options {}}"}
;; <=

;; @@

;; @@
